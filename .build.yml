image: archlinux
packages:
  - git
  - namcap
sources:
  - https://git.sr.ht/~samwhited/pkgbuilds
tasks:
  - setup: |
    cd pkgbuilds/
    git submodule init
    git submodule update
  - lint: |
    find pkgbuilds/ -name PKGBUILD -execdir namcap \{\} \;
  - build:
    find pkgbuilds/ -name PKGBUILD -execdir makepkg \{\} \;
  - check:
    find pkgbuilds/ -name '*.pkg.tar.xz' -execdir namcap \{\} \;
